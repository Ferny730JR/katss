PKG_CPPFLAGS = -ImtKmerCounter/include
PKG_LIBS = mtKmerCounter/build/libkatss.a

all: $(SHLIB)

$(SHLIB): mylibs
	$(CC) $(PKG_CPPFLAGS) -o $@ $(PKG_OBJECTS) $(PKG_LIBS) $(ALL_LIBS)

mylibs:
	(cd mtKmerCounter && mkdir -p build && cd build && \
	CC="$(CC)" CFLAGS="$(CFLAGS)" \
	CPPFLAGS="$(CPPFLAGS)" LDFLAGS="$(LDFLAGS)" \
	cmake .. -DCMAKE_BUILD_TYPE=Release \
	-DBUILD_SHARED_LIBS:bool=OFF \
	-DCMAKE_POSITION_INDEPENDENT_CODE:bool=ON && \
	$(MAKE))
